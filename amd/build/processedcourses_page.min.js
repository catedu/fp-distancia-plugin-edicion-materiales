/**
 * @author 3iPunt <https://www.tresipunt.com/>
 * @license http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 * @copyright 3iPunt <https://www.tresipunt.com/>
 */
define("local_educaaragon/processedcourses_page",["jquery","core/str","core/ajax","core/modal_factory","core/modal_events","core/templates","core/notification"],(function($,Str,Ajax,ModalFactory,ModalEvents,Templates,Notification){let ACTION_REPROCESSING_COURSE='[data-action="reprocessing_course"]',SERVICES_PROCESSEDTABLE="local_educaaragon_processed_table",SERVICES_REPROCESSING="local_educaaragon_reprocessing",REGION_TABLE='[data-region="processedcourses-table"]',TEMPLATES_TABLE="local_educaaragon/processedcourses_table",TEMPLATES_LOADING="core/overlay_loading";function Table(selector){this.node=$(selector),this.initReprocessingCourse()}return Table.prototype.node=null,Table.prototype.initReprocessingCourse=function(){this.node.find(ACTION_REPROCESSING_COURSE).on("click",this.reprocessingCourse)},Table.prototype.reprocessingCourse=function(e){e.preventDefault(),e.stopPropagation();let courseid=$(e.currentTarget).attr("data-courseid");Str.get_strings([{key:"reprocessing",component:"local_educaaragon"},{key:"reprocessingmsg",component:"local_educaaragon"},{key:"reprocess",component:"local_educaaragon"}]).then((function(langStrings){let title=langStrings[0],confirmMessage=langStrings[1],buttonText=langStrings[2];return ModalFactory.create({title:title,body:confirmMessage,type:ModalFactory.types.SAVE_CANCEL}).then((function(modal){return modal.setSaveButtonText(buttonText),modal.getRoot().on(ModalEvents.save,(function(){let identifier=$(REGION_TABLE);Templates.render(TEMPLATES_LOADING,{visible:!0}).done((function(html){identifier.append(html);let request={methodname:SERVICES_REPROCESSING,args:{courseid:courseid}};Ajax.call([request])[0].done((function(){let request={methodname:SERVICES_PROCESSEDTABLE,args:{}};Ajax.call([request])[0].done((function(response){let template=TEMPLATES_TABLE;Templates.render(template,response).done((function(html,js){identifier.html(html),Templates.runTemplateJS(js),location.reload()}))})).fail(Notification.exception)})).fail(Notification.exception)}))})),modal.getRoot().on(ModalEvents.hidden,(function(){modal.destroy()})),modal}))})).done((function(modal){modal.show()})).fail(Notification.exception)},{initClicks:function(selector){return new Table(selector)}}}));

//# sourceMappingURL=processedcourses_page.min.js.map